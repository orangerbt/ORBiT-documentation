
\documentclass[12pt,article]{memoir}

\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage{fontspec}
\setmainfont{Calibri}
\usepackage{tikz}
\usetikzlibrary{calc}
\usepackage{xcolor}
\usepackage{xpatch}
\usepackage{hyperref}
\usepackage{tabu}
\usepackage{float}
\usepackage{enumerate}


\usepackage[yyyymmdd]{datetime} % change date format to yyyy/mm/dd to fit ISO8601

\renewcommand{\familydefault}{\sfdefault} % set font
\renewcommand{\dateseparator}{--} % change date-seperators to - to fit ISO8601

\renewcommand\contentsname{Table of Contents}

\chapterstyle{section}
\renewcommand*{\chapnumfont}{\normalfont\HUGE\bfseries\sffamily}
\renewcommand*{\chaptitlefont}{\normalfont\HUGE\bfseries\sffamily}

\makeatletter 
% define macro for itemcode
\newcommand\itemcode[1]{\renewcommand\@itemcode{#1}}
\newcommand\@itemcode{}

% define macro for rev number
\newcommand\revnumber[1]{\renewcommand\@revnumber{#1}}
\newcommand\@revnumber{}
\makeatother

\definecolor{orbitOrange}{RGB}{250,62,0} % the ORBiT orange

\setlrmarginsandblock{2.5cm}{2.5cm}{*}
\setulmarginsandblock{2.5cm}{*}{1}
\checkandfixthelayout 

\setlength{\beforechapskip}{0cm} % reduce chapter spacing

\hypersetup{
    colorlinks,
    citecolor=black,
    filecolor=black,
    linkcolor=black,
    urlcolor=black
}

%**********************************************************************
%Document titles etc. defined here: (replace [] as well)
\title{OA-II Backplane Bus System Design}
\author{Jinzhi Cai}
\itemcode{DR00001}
\revnumber{A01}
\date{\today}
%end of document titles etc.
%**********************************************************************

\makeatletter
\let\runtitle\@title
\let\runitemcode\@itemcode
\makeatother

% set header style
\pagestyle{fancy}
{
	\fancyheadoffset{0cm}

	\lhead{\runtitle \ - \runitemcode}
	\rhead{Page: \thepage }
	%\chead{\leftmark} % section name
}

\newcommand{\OrbitBackground}{% For a logo drawn with TikZ
\begin{tikzpicture}[remember picture,overlay] % draw background
	\coordinate (bl) at (current page.south west);
	\coordinate (r) at (current page.east);
    \coordinate (A) at ($(bl)+(0,3cm)$);
    \coordinate (B) at ($(r)+(0,-2cm)$);
    \coordinate (C) at (current page.south east);
    \coordinate (ctrlNode) at ($(current page.south) + (0cm,1cm)$);
    \coordinate (ctrlNode2) at ($(current page.south east) + (-1cm,1cm)$);
    \fill[orbitOrange, fill opacity=0.2]
    (A) .. controls (ctrlNode) and (ctrlNode2) .. (B) -- (C) -- (bl);
    \node [white] at ($(C) + (-3cm,1cm)$) {2015-\the\year \ ORBiT@SU};
\end{tikzpicture}
}

\cfoot{\OrbitBackground}

\begin{document}

\begin{tikzpicture}[remember picture,overlay] % draw background
	\coordinate (bl) at (current page.south west);
	\coordinate (r) at (current page.east);
    \coordinate (A) at ($(bl)+(0,3cm)$);
    \coordinate (B) at ($(r)+(0,-2cm)$);
    \coordinate (C) at (current page.south east);
    \coordinate (ctrlNode) at ($(current page.south) + (0cm,1cm)$);
    \coordinate (ctrlNode2) at ($(current page.south east) + (-1cm,1cm)$);
    \fill[orbitOrange]
    (A) .. controls (ctrlNode) and (ctrlNode2) .. (B) -- (C) -- (bl);
    \node [white] at ($(C) + (-3cm,1cm)$) {2015-\the\year \ ORBiT@SU};
\end{tikzpicture}

\makeatletter
	\includegraphics[width=\textwidth]{../logo.jpg}\\[4ex]
	\begin{center}
	{\fontsize{50}{60}\selectfont \bfseries  \@title }\\[2ex] 
	{\LARGE  \@itemcode}\\
	\end{center}
	\begin{flushright}
	\vspace*{\fill}
	{\LARGE Rev: \@revnumber}\\[2ex]
	{\large \@author}\\[2ex]
	{\large \@date}\\[20ex]
	\end{flushright}
\makeatother
\thispagestyle{empty}
\newpage

\tableofcontents*
\thispagestyle{fancy}
\newpage

%**********************************************************************
% Everything after this is the main document. Edit below this line,

\chapter{Introduction}
\section{Scope}
This document analyze the requirement for OA-II VEH system data transmission, and current bus technology in the field, come up with a system design to fullfill the need of OA-II VEH system.
\section{Purpose}
The goal for the OA-II backplane bus system is constructure a high speed, high compatibility, and high robustness backplane data transmission system.
\chapter{Revision History}
\begin{table}[H]
	\centering
	\resizebox{0.8\textwidth}{!}{%
		\begin{tabu}{r || c | c | c }
		Rev\# & Editor & Delta & Date\\ \hline
		A01 & Jinzhi Cai & Initialize & 2019-7-15\\
		\end{tabu}
	}
	\caption{Summary of Revision History}
	\label{tab:rev}
\end{table}
\newpage
\chapter{BUS System Requirement}
\section{Hardware Requirement}
\begin{description}
	\item[\textbf{Backplane Bus}]The bus need to suppport swappable module
	\item[\textbf{Vribation-proof}]The bus need to have stronge support to the module on the frame.
	\item[\textbf{Size}]The size need to fit into the rocket.
	\item[\textbf{Topology}]The hardware structure need to support out-of-order locating.
\end{description}
\section{Software Requirement}
\begin{description}
	\item[\textbf{Max Speed}]The bus need to suppport swappable module
	\item[\textbf{Vribation-proof}]The bus need to have stronge support to the module on the frame.
	\item[\textbf{Size}]The size need to fit into the rocket.
	\item[\textbf{Topology}]The hardware structure need to support out-of-order locating.
\end{description}
\section{Bandwidth Calculation}

\subparagraph{Low Speed Payload}
Each low speed payload it sensing in 10kHz 16bit
\begin{itemize}
\item 4 high pressure sensors for propulsion system
\item 2 low pressure sensors for pitot tube
\item 4 high temp sensors for propulsion system
\item 4 low temp sensors for electronics
\item 4 low temp sensors for batteries
\item 2 low temp sensor for ambient
\end{itemize}
\begin{center}
$4+2+4+4+4+2=20 chennals$\\
$10kHz=10000Hz$\\
$16bit=2byte$\\
$10000Hz\times2byte=20000byte/s=20Kbyte/s$\\
$20Kbyte/s\times20=400Kbyte/s$
\end{center}

\subparagraph{High Speed Payload}
\begin{itemize}
\item 9 axis IMU
\item GNSS
\item 4x cameras
\end{itemize}
\begin{center}
9 axis IMU in 10kHz is\\
$9\times10000Hz\times2byte=180000byte/s=180Kbyte/s$
\end{center}
\begin{center}
GNSS module$\footnote{Did not include any fixing factor}$\\
UTC launch time 4byte\\
Latitude 4byte\\
Longitude 4byte\\
Height 4byte\\
Direction+Ground speed 4byte\\
$4byte\times5=20byte$\\
$10Hz\times20byte=200byte/s$
\end{center}
\begin{center}
Camera, set the bitrate to 8Mbps$\footnote{High bitrate is nessary for high virbation environment}$\\
$8Mbps=1Mbyte/s$\\
$1Mbyte/s\times4=4Mbyte/s$
\end{center}
\subparagraph{Total bandwidth}
\begin{center}
$(180Kbyte/s+4Mbyte/s+200byte/s+400Kbyte/s)\times2\approx10Mbyte/s$\\
\end{center}
\newpage
\chapter{Current Bus Analyze}
\section{I2C}
\section{SPI}
\section{UART}
\section{CAN}

\section{PCIe}
\section{RapidIO}
\newpage
\chapter{OA-II BUS Hardware Structure}
\newpage
\chapter{OA-II BUS Software Structure}
\newpage
%end of document
%**********************************************************************
\end{document}